import os
import torch
import multiprocessing

# original dataset i.e. binary executable files
ORG_DATASET_PATH = os.path.join('data', 'exec_files', 'org_dataset')

# image files from binaries
ORG_DATASET_PATH_IMAGE0 = os.path.join('data', 'exec_files', 'org_dataset_width_0')
ORG_DATASET_PATH_IMAGE1 = os.path.join('data', 'exec_files', 'org_dataset_width_1')
ORG_DATASET_PATH_IMAGE64 = os.path.join('data', 'exec_files', 'org_dataset_width_64')
ORG_DATASET_PATH_IMAGE128 = os.path.join('data', 'exec_files', 'org_dataset_width_128')
ORG_DATASET_PATH_IMAGE256 = os.path.join('data', 'exec_files', 'org_dataset_width_256')
ORG_DATASET_PATH_IMAGE512 = os.path.join('data', 'exec_files', 'org_dataset_width_512')
ORG_DATASET_PATH_IMAGE1024 = os.path.join('data', 'exec_files', 'org_dataset_width_1024')

# opcodes from binary executables
ORG_DATASET_OPCODES_PATH = os.path.join('data', 'exec_files', 'org_dataset_opcodes')
OPCODE_LEN = 500
OPCODE_LEN_STR = '_' + str(OPCODE_LEN)
if OPCODE_LEN == -1:
    OPCODE_LEN_STR = ''
ORG_DATASET_OPCODES_SPLIT_PATH = os.path.join('data', 'exec_files', 'org_dataset_opcodes_split' + OPCODE_LEN_STR)
ORG_DATASET_OPCODES_TRAIN_SPLIT_JSON = os.path.join('data', 'org_dataset_opcodes_train' + OPCODE_LEN_STR + '.json')
ORG_DATASET_OPCODES_TEST_SPLIT_JSON = os.path.join('data', 'org_dataset_opcodes_test' + OPCODE_LEN_STR + '.json')

# PE features from binary executables
ORG_DATASET_PE_FEATURES_CSV = os.path.join('data', 'org_malware_dataset_pe_features.csv')

# count files for ORG_DATASET_PATH
ORG_DATASET_COUNT_CSV = os.path.join('data', 'org_malware_dataset_count.csv')
# count files for ORG_DATASET_PATH_IMAGE*
ORG_DATASET_COUNT_IMAGES_CSV = os.path.join('data', 'org_malware_dataset_count_images.csv')
# count files for ORG_DATASET_OPCODES_PATH
ORG_DATASET_COUNT_PE_FEATURES_CSV = os.path.join('data', 'org_malware_dataset_count_pe_features.csv')
# count files for ORG_DATASET_PE_FEATURES_CSV
ORG_DATASET_COUNT_OPCODES_PATH = os.path.join('data', 'org_malware_dataset_count_opcodes.csv')

use_cuda = torch.cuda.is_available()
device = torch.device("cuda" if use_cuda else "cpu")
LINE_LEN = 80
LOG_MASTER_DIR = 'logs'
MODEL_INFO_LOG = 'model_info_and_results.log'
MODEL_META_INFO_LOG = 'models_meta_info.log'
MODEL_LOSS_INFO_LOG = 'model_losses.log'
MODEL_ACC_INFO_LOG = 'model_acc.log'
MODEL_CONF_MATRIX_CSV = 'confusion_matrix.csv'
MODEL_CONF_MATRIX_PNG = 'confusion_matrix.png'
MODEL_CONF_MATRIX_NORMALIZED_CSV = 'confusion_matrix_normalized.csv'
MODEL_CONF_MATRIX_NORMALIZED_PNG = 'confusion_matrix_normalized.png'
MODEL_ACCURACY_PNG = 'model_accuracy.png'
MODEL_LOSS_PNG = 'model_loss.png'
EXPERIMENT_RESULTS = 'experiments_results.csv'
CPU_COUNT = multiprocessing.cpu_count()

DEEP_FF = 'deep_feed_forward'
DEEP_RNN = 'rnn'
SHALLOW_ML = 'shallow_ml'
DATA_TYPE_IMAGE = 'image'
DATA_TYPE_OPCODE = 'opcode'

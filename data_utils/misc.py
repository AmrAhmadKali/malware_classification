import os
from tqdm import tqdm


def count_dataset(root_data_dir, csv_filename):
    class_names = os.listdir(root_data_dir)
    class_count = len(class_names)

    csv_delimiter = ','
    count_columns = ['class_name', 'total_samples']
    count_csv_file = open(csv_filename, "w")

    count_csv_file.write(csv_delimiter.join(count_columns) + "\n")

    for class_id in tqdm(range(class_count), desc='Counting dataset'):
        files = os.listdir(os.path.join(root_data_dir, class_names[class_id]))
        count_csv_file.write(class_names[class_id] + csv_delimiter + str(len(files)) + "\n")

    count_csv_file.close()
